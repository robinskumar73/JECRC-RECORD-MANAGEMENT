var app=app||{};app.Views=app.Views||{};app.Global=app.Global||{};app.Views.Department=Backbone.View.extend({el:$("#DepartmentCreate"),events:{"click #create-dept":"createDepartment","keypress #Department":"handleKeyPress","click #Dept-Cancel":"cancel_department"},createDepartment:function(){app.Global.DepartmentPresentAlready=false;app.Global.selDeptModel=null;value=$("#Department").val();if(value===""){return null}$($("#DepartmentCreate ").children()).addClass("hide");$("#Dept-Cancel").removeClass("hide");$("#dept-screen").removeClass("hide");$("a.navbar-text navbar-right jecrc-nav-dept").click(function(e){e.preventDefault()});$("#AddSemester").removeClass("hide");$("#infoScreen").removeClass("hide");$(".infoScreenHeader").html(value);if(app.Global.Department.findWhere({name:value})!==undefined){app.Global.selDeptModel=app.Global.Department.findWhere({name:value});app.Global.DepartmentPresentAlready=true;return null}app.Global.Department.create({name:value},{headers:{faculty_id:faculty.id},error:function(e,t){displayMessage("Error saving department..");revertDeptToInitial()},success:function(e){console.log("Successfully added department to database..");displayMessage("Successfully added department to database..");app.Global.selDeptModel=e}})},render:function(){$("#nav-dept-bar").html("");var e=app.Global.Department.length;for(var t=0;t<e;t++){if(faculty.admin_type==="admin"){$("#nav-dept-bar").append('<li><a href="#department/'+app.Global.Department.at(t).get("name")+'"  >'+app.Global.Department.at(t).get("name")+"</a></li>");$("#collapse-nav-bar").append('<li class="jecrc-nav-hide"><a href="#department/'+app.Global.Department.at(t).get("name")+'"  >'+app.Global.Department.at(t).get("name")+"</a></li>")}else{if(faculty.department_id===app.Global.Department.at(t).get("id")){$("#nav-dept-bar").append('<li><a href="#department/'+app.Global.Department.at(t).get("name")+'"  >'+app.Global.Department.at(t).get("name")+"</a></li>");$("#collapse-nav-bar").append('<li class="jecrc-nav-hide"><a href="#department/'+app.Global.Department.at(t).get("name")+'"  >'+app.Global.Department.at(t).get("name")+"</a></li>")}}}return this},handleKeyPress:function(e){var t=e.which;if(t==13){this.createDepartment()}},cancel_department:function(e){e.preventDefault();var t=app.Global.Department.length;if(!app.Global.DepartmentPresentAlready&&app.Global.Department.at(t-1)===app.Global.selDeptModel){var n=app.Global.Department.pop();var r=$("#nav-dept-bar").children().length;$($("#nav-dept-bar").children()[r-1]).remove()}revertDeptToInitial();hideBatch();hideSection()},initialize:function(){this.listenTo(app.Global.Department,"add",this.displayNavigationBar);this.listenTo(app.Global.Department,"remove",this.removeNavigationBar)},removeNavigationBar:function(e){if(!app.Global.DepartmentPresentAlready){console.log("repetition not found");e.destroy({error:function(e,t){displayMessage("Error removing department..");app.Global.Department.add(e)},success:function(e,t){console.log("Successfully deleted department..");displayMessage("Successfully deleted department..")},headers:{faculty_id:faculty.id}})}},displayNavigationBar:function(e){value=e.get("name");if(faculty.admin_type==="admin"){$("#nav-dept-bar").append('<li><a href="#department/'+value+'"  >'+value+"</a></li>");$("#collapse-nav-bar").append('<li class="jecrc-nav-hide"><a href="#department/'+value+'"  >'+value+"</a></li>")}else{if(faculty.admin_type==="hod"){if(faculty.department_id===e.get("id")){$("#nav-dept-bar").append('<li><a href="#department/'+value+'"  >'+value+"</a></li>");$("#collapse-nav-bar").append('<li class="jecrc-nav-hide"><a href="#department/'+value+'"  >'+value+"</a></li>")}}}}});var displayMessage=function(e){$("#dept-info-box").removeClass("hide");$("#dept-info-box").html(e);setTimeout(function(){$("#dept-info-box").addClass("hide")},4e3)};var revertDeptToInitial=function(){$("#Department").val("");$($("#DepartmentCreate ").children()).removeClass("hide");$("#Dept-Cancel").addClass("hide");$("#dept-screen").addClass("hide");$("a.navbar-text navbar-right jecrc-nav-dept").bind("click");$("#AddSemester").addClass("hide")};var dept_views=new app.Views.Department;app.Views.Semester=Backbone.View.extend({el:$("#radio-btn"),events:{"change input[name=options]":"addSemester"},addSemester:function(e){var t=$(".radio:checked").val();app.Global.semester_id=t;var n=app.Global.selDeptModel;var r=n.get("name");this.showSection();this.updateInfoBox(r,t)},showSection:function(){$("#AddSection").removeClass("hide")},updateInfoBox:function(e,t){$(".infoScreenHeader").html(""+t+""+e+"")}});var semesterView=new app.Views.Semester;$(document).on("change","#section-btn input[name=options]",function(){var e=app.Global.semester_id;var t=$(this).val();app.Global.section_id=t;var n=app.Global.selDeptModel;var r=n.get("name");showBatch();$(".infoScreenHeader").html(e+r+t)});var showBatch=function(){$("#AddBatches").removeClass("hide")};var hideBatch=function(){$("#AddBatches").addClass("hide");$("#publish-batch").addClass("hide")};var hideSection=function(){$("#AddSection").addClass("hide")};app.Views.Batch=Backbone.View.extend({el:$("#AddBatches"),events:{"click .dept-check ":"onClick"},onClick:function(e){setTimeout(this.count)},count:function(){var e=[];$(".infoScreenSubHeader").html("");$(".dept-check").each(function(t,n){if($(n).hasClass("active")){e.push($(n).data("wat"));showinfoScreenSubHeader();var r=app.Global.selDeptModel;var i=r.get("name");$(".infoScreenSubHeader").append('<span class="h4">'+app.Global.semester_id+i+app.Global.section_id+$(n).data("wat")+"</span>")}});app.Global.Batches=e}});var batch=new app.Views.Batch;var showinfoScreenSubHeader=function(){$(".infoScreenSubHeader").removeClass("hide");$("#publish-batch").removeClass("hide")};$(document).on("click","#publish-batch",function(e){var t=app.Global.Batches;var n=app.Global.semester_id;var r=app.Global.selDeptModel;var i=app.Global.section_id;$(".dept-check").each(function(e,t){if($(t).hasClass("active")){var s=$(t).data("wat");app.Global.Branch.create({department_id:r.get("id"),semester_id:n,section_name:i,batch_id:s},{error:function(e,t){displayMessage("Error saving Branch..");$("#Dept-Cancel").click()},success:function(e){displayMessage("Successfully added branch to database..");hideBatch();hideSection();$("#infoScreen").addClass("hide");$("#AddSemester").addClass("hide");$("#dept-screen").addClass("hide");$("#Dept-Cancel").addClass("hide");$("#Department").removeClass("hide");$("#Department").val("");$("#create-dept").removeClass("hide");$("#DepartmentCreate").removeClass("hide");$("span.twitter-typeahead").removeClass("hide")}})}})});app.Views.periodEntry=Backbone.View.extend({tagName:"div",className:"col-md-12",initialize:function(){app.Global.Router.currentView=this;this.fetchMore(this.collection);this.deptDataObj={};var e=this;$(window).scroll(_.debounce(function(){if($(window).scrollTop()+$(window).height()>$(document).height()-100){console.log("scroll position: near  bottom!");e.fetchMore(e.collection)}},300))},fetchMore:function(e){console.log("Inside fetch more function..");var t=this;app.Global.showLoadingBar();e.fetch({error:function(e,t,n){app.Global.hideLoadingBar();console.log("Error fetching department wise entry from database..")},success:function(n,r,i){var s=t.branchUniqueObject(e);for(var o in s){var u=s[o];var a=u["department_id"];var f=u["semester_id"];var l=u["section_name"];var c=app.Global.Department.findWhere({id:a}).get("name");var h=e.where(u);if(t.deptDataObj[o]){t.$el=t.deptDataObj[o]}else{t.$el.append("<h4 class='report-dept-info'>"+f+" "+c+"</h4>");t.$el.append("<span class='report-dept-info'>"+l+"</span><hr class='report-dept-info' style='margin-top:0px;margin-bottom:0px;'>")}var p=new app.Collection.periodEntry(h);var d=p.pluck("days_entry_id");var v=_.uniq(d,true);v=_.sortBy(v,function(e){return e});v=v.reverse();console.info("Printing the department wise entry arr");console.log(v);t.deptDataObj[o]=t.$el;for(var m=0;m<v.length;m++){t.entry_model_arr=e.where({days_entry_id:v[m]});t.afterFetch(t.entry_model_arr);$("#jecrc-main-screen").append(t.render().el)}}t.collection.data.offset=parseInt(t.collection.data.offset)+parseInt(t.collection.data.limit);app.Global.hideLoadingBar()},data:t.collection.data})},afterFetch:function(e){if(e.length===0){console.log("destroying the period entry view as zero data fetched from the server");this.destroy_view()}this.lab={row0:null,row1:null,row2:null};this.LabPeriodAdd=[];this.periodList=$("<tr/>");this.subjectList=$("<tr/>");this.strengthList=$("<tr/>");this.teacherList=$("<tr/>");this.date=e[0].get("date");this.department_name=app.Global.Department.findWhere({id:e[0].get("department_id")}).get("name");this.section_name=e[0].get("section_name");this.semester_id=e[0].get("semester_id");this.day=getDay(this.date);this.parse_date=convertDate(this.date)},branchUniqueObject:function(e){var t={};e.each(function(e){var n=e.get("semester_id")+" - "+e.get("department_id")+" - "+e.get("section_name");t[n]={semester_id:e.get("semester_id"),department_id:e.get("department_id"),section_name:e.get("section_name")}});return t},render:function(){this.addBody(this.day,this.parse_date);var e=$("<thead />");var t=$("<tbody />");e.append(this.periodList);this.table.append(e);t.append(this.subjectList);t.append(this.strengthList);t.append(this.teacherList);this.addToList(this.entry_model_arr);this.table.append(t);return this},addBody:function(e,t){this.$el.append("<h4 class='log_day'>"+e+"</h4>");this.$el.append("<span class='log_date'>"+t+"</span>");var n=$("<div class='col-md-12 jecrc-stats' />");var r=$("<div class='table-responsive'/>");this.table=$("<table class='table table-striped'/>");n.append(r);r.append(this.table);this.$el.append(n);this.$el.append("<br />")},addToList:function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.get("lab")==="0"){for(var r=0;r<n.get("period").length;r++){this.periodList.append("<th>"+n.get("period")[r]+"</th>")}var i=n.get("period").length;this.subjectList.append("<td colspan='"+i+"' >"+n.get("subject_name")+"</td>");this.strengthList.append("<td  colspan='"+i+"' >"+n.get("strength")+"</td>");this.teacherList.append("<td class='faculty_name_tuple' data-toggle='tooltip' data-placement='top' title='Faculty :  "+n.get("faculty_name").toUpperCase()+"' colspan='"+i+"' >"+getInitialFacultyName(n.get("faculty_name"))+"</td>")}else{var s=null;var o=[];for(var u=0;u<this.LabPeriodAdd.length;u++){var a=this.LabPeriodAdd[u].lab;var f=this.LabPeriodAdd[u].period;var l=n.get("period");if($(f).not(l).length==0&&$(l).not(f).length==0){s=a;o=this.LabPeriodAdd[u].id;break}}if(s===null){var a={row0:null,row1:null,row2:null};var f=n.get("period");s=a;var c=app.Global.randomNumber(999,999999);var h=app.Global.randomNumber(999,999999);var p=app.Global.randomNumber(999,999999);o=[c,h,p];this.LabPeriodAdd.push({period:f,lab:a,id:o})}if(s["row0"]===null){for(var r=0;r<n.get("period").length;r++){this.periodList.append("<th>"+n.get("period")[r]+"</th>")}}var d=n.get("subject_name");var v=n.get("section_name");var m=n.get("batch");var g=n.get("strength");var y=getInitialFacultyName(n.get("faculty_name"));var i=n.get("period").length;if(s["row0"]===null){row="0";this.subjectList.append("<td id='"+o[0]+"'  colspan='"+i+"'  rowspan='"+row+"'  >"+d+" -  "+v+m+" Batch  -"+g+" - "+y+"</td>");this.strengthList.append("<td id='"+o[1]+"'  colspan='"+i+"'  rowspan='"+"1"+"'  >"+" -------  "+"</td>");this.teacherList.append("<td  id='"+o[2]+"'  colspan='"+i+"'  rowspan='"+"2"+"'  >"+" ------- "+"</td>");s["row0"]=true}else if(s["row1"]===null){var b=this.strengthList.find("td#"+o[1]);$(b).html(d+" -  "+v+m+" Batch  -"+g+" - "+y);row="1";s["row1"]=true}else{row="2";var b=this.teacherList.find("td#"+o[2]);$(b).html(d+" -  "+v+m+" Batch  -"+g+" - "+y);s["row2"]=true;s["row0"]=null;s["row1"]=null;s["row2"]=null}}}}});app.Views.FacultyEntry=Backbone.View.extend({el:$("#faculty-entry-record"),initialize:function(){this.dept_name=this.model.get("name");this.Template=_.template($("#faculty-entry-form").html());this.form=this.Template({department:this.dept_name})},render:function(){$(this.el).empty();$(this.el).append(this.form);return this}});app.Views.Branch=Backbone.View.extend({initialize:function(){app.Global.Router.currentView=this;this.childViews=[];if(this.collection.length===0){console.log("returning from branch view initialize");return null}var e=this.collection.at(0).get("department_id");this.dept_name=app.Global.Department.findWhere({id:e}).get("name");this.year=["I YEAR","II YEAR","III YEAR","IV YEAR"];this.branchTemplate=_.template($("#branch-template").html());app.Global.dept=false;this.editButton=false},events:{},removeBranch:function(){},showEditBranchIcons:function(){if(!this.editButton){$(".branch-remove-icons").removeClass("hide");this.editButton=true}else{$(".branch-remove-icons").addClass("hide");this.editButton=false}},render:function(){$(this.el).empty();if(this.collection.length===0){return null}var e={};e.department=this.dept_name;e.years=[];var t=[];var n=0;for(var r=0;r<4;r++){var i={};i.branches=[];var s=this.collection.where({semester_id:String(n+1)});if(s!==undefined&&!$.isEmptyObject(s)){for(var o=0;o<s.length;o++){i.branches.push(s[o])}}s=this.collection.where({semester_id:String(n+1+1)});n=n+1+1;if(s!==undefined&&!$.isEmptyObject(s)){for(o=0;o<s.length;o++){i.branches.push(s[o])}}app.Global.section_added=[];i.branches=this.branchArray(i.branches);i.yearname=this.year[r];t.push(i)}e.years=t;$(this.$el).html(this.branchTemplate(e));var u=new app.Model.Faculty;u.set("department_id",this.collection.at(0).get("department_id"));var a=new app.Views.CreateFaculty({model:u});a["department_id"]=this.collection.at(0).get("department_id");this.childViews.push(a);$("#right-side-hook").append(a.render().el);var f=new app.Views.ShowFaculty;f.department_id=this.collection.at(0).get("department_id");f.fetchMore();$("#right-side-hook").append(f.el);this.childViews.push(f);return this},branchArray:function(e){var t=[];for(var n=0;n<e.length;n++){var r={};var i=e[n];var s=i.get("id");var o=i.get("semester_id");var u=i.get("section_name");var a=i.get("batch_id");r.id=s;var f=o+" - "+this.dept_name+" - "+u;if(app.Global.section_added.indexOf(f)===-1){app.Global.section_added.push(f);r.name=f;t.push(r)}}return t},displayMessage:function(e,t){var n=_.template($("#display-info").html());this.display=n({message:e,typeInfo:t});var r=this.$el.find("#display-info-box");$(r).html(this.display)}});app.Views.CreateFaculty=Backbone.View.extend({initialize:function(){this.template=_.template($("#Create-Faculty-Template").html());this.listenTo(this.model,"invalid",this.validationFailed)},getValue:function(){var e=$("#faculty-first-name").val();var t=$("#faculty-last-name").val();var n=$("#faculty-user-name").val();var r=$("#faculty-email-address").val();if(!e.length&&!t.length&&!n.length&&!r.length){message="All <strong>values</strong> must be entered.";this.displayMessage(message,app.Global.alertType[3]);return false}var i={first_name:e,last_name:t,username:n,email_address:r};return i},events:{"click  #faculty-create-btn":"saveEntry","click  #faculty-reset-btn":"resetEntry"},render:function(){this.$el.append(this.template());return this},saveEntry:function(e){obj=this.getValue();if(!obj){return false}obj["department_id"]=this.department_id;var t=this;this.model.save(obj,{success:function(e,n){t.resetEntry();console.log("Succesfully created faculty!");var r="<strong>Faculty created</strong>.								<p> Faculty Name: <strong>"+obj.first_name+" "+obj.last_name+"</strong></p>  								<p> Faculty Pass: <strong>"+n.pass_string+"</strong> </p> 								<p><strong>Note</strong>:Change this password as soon as you login.</p>";t.displayMessage(r,app.Global.alertType[1]);t.model.clear({silent:true})},error:function(e,n){t.resetEntry();console.log("Error created faculty!");if(n.responseText.length<30){var r=n.responseText}else{var r="Error creating faculty!"}t.displayMessage(r,app.Global.alertType[3]);t.model.clear({silent:true})},headers:{faculty_id:faculty.id}})},resetEntry:function(){var e=$("#faculty-first-name").val("");var t=$("#faculty-last-name").val("");var n=$("#faculty-user-name").val("");var r=$("#faculty-email-address").val("")},validationFailed:function(e){this.displayMessage(e.validationError,app.Global.alertType[3])},displayMessage:function(e,t){var n=_.template($("#display-info").html());this.display=n({message:e,typeInfo:t});var r=this.$el.find("#admin-faculty-info-box");$(r).html(this.display)}});app.Views.ShowFaculty=Backbone.View.extend({initialize:function(){this.childViews=[];this.offset=0;this.limit=10;this.facultyList=new app.Collection.Faculty;this.template=_.template($("#faculty-list-collection").html());this.$el.append(this.template());this.listenTo(this.facultyList,"add",this.addFacultyList);this.listenTo(this.facultyList,"reset",this.resetFaculty);this.listenTo(this.facultyList,"remove",this.deleteFaculty);var e=this;$(window).scroll(_.debounce(function(){if($(window).scrollTop()+$(window).height()>$(document).height()-100){console.log("scroll position: near  bottom!");e.fetchMore()}},300))},addFacultyList:function(e){console.log("Adding models;");var t=new app.Views.FacultyItem({model:e});t.listCollection=this.facultyList;this.childViews.push(t);$("ul.faculty-list").append(t.render().el)},resetFaculty:function(){app.Global.facultyList.each(this.addFacultyList,this)},fetchMore:function(){var e=this;var t=false;if(parseInt(this.offset)){t=true}app.Global.showLoadingBar();this.facultyList.fetch({remove:false,data:{offset:e.offset,limit:e.limit,dept_id:e.department_id},error:function(e,t,n){app.Global.hideLoadingBar();console.log("Error fetching faculty list collection from server.")},success:function(n,r,i){app.Global.hideLoadingBar();if(r.length===0&&!t){e.destroy_view();return false}var s=r.length;e.offset=e.offset+s}})},deleteFaculty:function(){this.offset=parseInt(this.offset)-1}});app.Views.FacultyItem=Backbone.View.extend({initialize:function(){app.Global.facultyList.reset();this.template=_.template($("#faculty-list-item").html());this.listenTo(this.model,"destroy",this.deleteFaculty);this.detachElement=null},tagName:"li",className:"faculty-list-items",events:{"dblclick #faculty-list-item-full-name":"edit","click #faculty-item-edit":"edit","click #faculty-create-btn":"updateModel","click #faculty-item-delete":"deleteModel","click #faculty-reset-btn":"cancelUpdate","click #entry-action-btn":"confirmDelete","close.bs.alert #dept-display-box":"cancelDelete"},edit:function(e){e.preventDefault();var t=this.$el.find("#faculty-list-item-full-name");$(t).addClass("hide");this.detachElement=this.$el.find("p");this.detachElement=$(this.detachElement).detach();var n=this.$el.find("#faculty-edit-list");$(n).removeClass("hide");$(this.$el).css("margin-bottom","80px");$(this.$el).css("margin-top","50px")},cancelUpdate:function(){console.log("Updating the models...");var e=this.$el.find("#faculty-list-item-full-name");$(e).removeClass("hide");if(this.detachElement){this.$el.append(this.detachElement);this.detachElement=null}var t=this.$el.find("#faculty-edit-list");$(t).addClass("hide");$(this.$el).css("margin-bottom","0px");$(this.$el).css("margin-top","0px")},deleteModel:function(){this.detachElement=this.$el.find("p");this.detachElement=$(this.detachElement).detach();var e=this.$el.find("#faculty-list-item-full-name");$(e).addClass("h4");var t=_.template($("#entry-log-alert-body").html());this.displayMessage(t(),app.Global.alertType[0])},cancelDelete:function(){var e=this.$el.find("#faculty-list-item-full-name");$(e).removeClass("hide");$(e).removeClass("h4");if(this.detachElement){this.$el.append(this.detachElement);this.detachElement=null}var t=this.$el.find("#faculty-edit-list");$(t).addClass("hide")},confirmDelete:function(){if(faculty.id===this.model.get("id")){var e="<strong>Error:</strong> You cannot delete your <strong>own account</strong>. ";this.displayMessage(e,app.Global.alertType[0]);return false}var t=this.$el.find("#faculty-list-item-full-name");$(t).removeClass("hide");$(t).removeClass("h4");if(this.detachElement){this.$el.append(this.detachElement);this.detachElement=null}var n=this.$el.find("#faculty-edit-list");$(n).addClass("hide");$(this.$el).css("margin-bottom","0px");$(this.$el).css("margin-top","0px");this.model.destroy({success:function(){console.log("successfully delete faculty from server..")},error:function(){console.log("Error deleting faculty from server..")},headers:{faculty_id:faculty.id}})},updateModel:function(e){console.log("Updating the models...");var t=this.$el.find("#faculty-list-item-full-name");$(t).removeClass("hide");if(this.detachElement){this.$el.append(this.detachElement);this.detachElement=null}var n=this.$el.find("#faculty-edit-list");$(n).addClass("hide");$(this.$el).css("margin-bottom","0px");$(this.$el).css("margin-top","0px");var r=this.getValue();if(!r){var i="Fields cannot be left <strong>blank</strong>";this.displayMessage(i,app.Global.alertType[3]);return false}this.model.set(r);var s=this;this.model.save(null,{success:function(){console.log("successfully updated faculty info to the server..");var e=s.listCollection.get(s.model.get("id"));s.render()},error:function(){console.log("Error updating faculty info to the server.");var e="<strong>Errror</strong> updating faculty information to the server.<strong>Please try again sometime later</strong>";this.displayMessage(e,app.Global.alertType[3])},headers:{faculty_id:faculty.id}})},getValue:function(){var e=this.$el.find("#faculty-edit-first-name");var t=$(e).val();var n=this.$el.find("#faculty-edit-last-name");var r=$(n).val();var i=this.$el.find("#faculty-edit-username");var s=$(i).val();var o=this.$el.find("#faculty-edit-email-address");var u=$(o).val();if(!t.length&&!r.length&&!s.length&&!u.length){return false}var a={first_name:t,last_name:r,username:s,email_address:u};return a},render:function(){console.info("Rendering the faculty item model");this.$el.empty();var e=this.model.get("first_name")+" "+this.model.get("last_name");this.model.set("name",e);var t=this.template(this.model.toJSON());this.$el.append(t);return this},deleteFaculty:function(e){app.Global.facultyList.remove(e);this.destroy_view()},displayMessage:function(e,t){var n=_.template($("#display-info").html());this.display=n({message:e,typeInfo:t});var r=this.$el.find("#faculty-list-item-display-info");$(r).html(this.display)}});app.Views.activity=Backbone.View.extend({initialize:function(){app.Global.Router.currentView=this;this.childViews=[];this.listenTo(this.collection,"add",this.addOne);this.listenTo(this.collection,"reset",this.addAll);this.offset=0;this.limit=10;this.daysEntryRecord={};this.fetchMore();var e=this;$(window).scroll(_.debounce(function(){if($(window).scrollTop()+$(window).height()>$(document).height()-100){console.log("scroll position: near  bottom!");e.fetchMore()}},300))},fetchMore:function(){var e=this;app.Global.showLoadingBar();var t=faculty.id;this.collection.fetch({data:{offset:e.offset,limit:e.limit,faculty_id:t},remove:false,error:function(e,t,n){app.Global.hideLoadingBar();console.log("Error fetching collection from admin_log collection.")},success:function(t,n,r){app.Global.hideLoadingBar();console.log("Successfully fetched data of admin_log from server.");var i=n.length;e.offset=e.offset+i}})},addOne:function(e){var t=e.get("date");var n=getDay(t);var r=convertDate(t);if(this.daysEntryRecord[t]===undefined){var i=$('<div class="col-md-12 col-xs-12 "></div>');var s=$('<h4 class="log_day"></h4>');var o=$('<span class="log_date"></span>');var u=$('<ul class="jecrc-stats log"></ul>');i.append(s);$(this.$el).append(i);s.append(n);i.append(o);o.append(r);i.append(u);this.daysEntryRecord[t]=u}var a=new app.Views.activityModel({model:e});this.childViews.push(a);$(this.daysEntryRecord[t]).append(a.render().el)},addAll:function(){console.log("resetting  the log entry view...");this.collection.each(this.addOne,this)},render:function(){$(this.$el).empty();if(this.collection.length){this.addAll()}return this}});app.Views.activityModel=Backbone.View.extend({initialize:function(){this.template=_.template($("#faculty_home_log").html())},tagName:"li",render:function(){this.$el.html(this.template(this.model.toJSON()));return this}});app.Views.settings=Backbone.View.extend({initialize:function(){app.Global.Router.currentView=this;this.template=_.template($("#template-reset-settings").html())},events:{"click #settings-delete-btn":"confirmDelete","click #alert_modal_save_btn":"confirmPassBtn"},render:function(){this.$el.html(this.template());return this},confirmDelete:function(){var e=_.template($("#alert-password-confirm-modal").html());this.$el.append(e());var t=this.$el.find("#myModal");$("#myModal").modal("show")},confirmPassBtn:function(){var e=this.$el.find("#pass-confirm");var t=$(e).val();if(t===""){console.warn("Pass must be entered");return false}var n=CryptoJS.MD5(t);console.log("Confirm Password is "+n.toString());var r=this;$.ajax({url:"/Manage/modules/department.php/settings",type:"DELETE",success:function(e){console.info("Succesfullty reset entry");r.displayMessage("Data entry <strong>successfully deleted.</strong>",app.Global.alertType[1])},error:function(){r.displayMessage("<strong>Error wrong password.</strong> Please type your <strong>password correctly</strong>.",app.Global.alertType[3])},headers:{password:n.toString(),faculty_id:faculty.id}});var i=this.$el.find("#myModal");$("#myModal").modal("hide")},displayMessage:function(e,t){var n=_.template($("#display-info").html());this.display=n({message:e,typeInfo:t});var r=this.$el.find("#settings-delete-info");$(r).html(this.display)}})