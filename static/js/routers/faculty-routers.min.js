app.Routers=app.Routers||{};app.Routers=Backbone.Router.extend({routes:{"department/:name":"showDepartment","department/:dept_name/semester/:semester_name/section/:section_name":"FacultyEntry","*path":"ShowLogActivity",},closePreviousViews:function(){console.log("Closing the pervious in memory views...");if(this.currentView){this.currentView.destroy_view()}},ShowLogActivity:function(){this.closePreviousViews();$(window).unbind("scroll");if(!$("#jecrc-main-screen").length===1){var b=$("<div id='faculty-display-screen'></div>");$("#jecrc-main-screen").prepend(b)}console.log("loading the default route..");var a=new app.Views.activity({collection:app.Global.entryLogCollection});a.render();$("#faculty-display-screen").html(a.el)},FacultyEntry:function(d,b,a){this.closePreviousViews();$(window).unbind("scroll");if($("#faculty-display-screen").length){var c=$("<div id='faculty-display-screen'></div>");$("#jecrc-main-screen").prepend(c)}if(app.Global.Department.length===0){app.Global.Department.fetch({error:function(){console.log("Error fetching department..")},success:function(){FacultyBranchEntry(d,b,a)}})}else{FacultyBranchEntry(d,b,a)}},showDepartment:function(a){this.closePreviousViews();$(window).unbind("scroll");console.log("Showing the branches");fetchBranch(a)}});var fetchBranch=function(a){$("#faculty-entry-record").empty();app.Global.showLoadingBar();app.Global.Branch.fetch({error:function(){app.Global.hideLoadingBar();console.log("Error fetching branch from database..")},success:function(b){console.log("Successfully fetched branch data..");if(app.Global.Department.findWhere({name:a})===undefined){app.Global.Department.fetch({error:function(){console.log("Error fetching department..")},success:function(){console.log("Successfully fecthed department data..");app.Global.render_department(a)}})}else{app.Global.render_department(a)}}})};app.Global.render_department=function(b){var c=app.Global.Department.findWhere({name:b}).get("id");if(c===undefined){return null}var d=app.Global.Branch.where({department_id:c});var e=new app.Collection.Branch(d);var a=new app.Views.Branch({collection:e});a.render();$("#faculty-display-screen").html(a.el);console.log("loading bar is getting hide..");app.Global.hideLoadingBar()};var FacultyBranchEntry=function(e,b,a){app.Global.showLoadingBar();var d=new app.Collection.periodEntry;var c=getTodayDate();periodDisplay(e,b,a,d)};var periodDisplay=function(d,c,a,b){b.fetch({data:{dept_name:d,sem:c,sec_name:a,todayEntry:"1"},error:function(){app.Global.hideLoadingBar();console.log("Error fetching department wise entry from database..")},success:function(j){app.Global.hideLoadingBar();console.log("Successfully fetched faculty today entry data..");$("#faculty-display-screen").empty();var g=$.unique(b.pluck("days_entry_id"));if(g.length){$("#faculty-display-screen").html("");for(var e=0;e<g.length;e++){var h=b.where({days_entry_id:g[e]});console.log("Getting the entry model arr length");var f=new app.Views.periodEntry({collection:h});$("#faculty-display-screen").append(f.render().el)}}else{var f=new app.Views.periodEntry({collection:[]});$("#faculty-display-screen").append(f.render().el)}PeriodEntryRender(d,c,a,b,f)}})};var PeriodEntryRender=function(d,h,c,f,g){var a=app.Global.Department.findWhere({name:d});if(a===undefined){app.Global.Department.fetch({error:function(){console.log("Error fetching department..")},success:function(){console.log("Successfully fecthed department data..");var m=app.Global.Department.findWhere({name:d});var l={department_name:m.get("name"),department_id:m.get("id"),semester_id:h,section_name:c};var k=new app.Model.periodEntry(l);console.log("Rendering the Faculty Entry data..");var j=new app.Views.FacultyEntry({model:k,collection:f});j.render()}})}else{var b={department_name:a.get("name"),department_id:a.get("id"),semester_id:h,section_name:c};console.log("I am rendering period entry");var i=new app.Model.periodEntry(b);var e=new app.Views.FacultyEntry({model:i,collection:f,});e.update=0;if(g.childViews){console.info("Adding child views to period entry!");g.childViews.push(e)}$("#faculty-entry-record").html(e.render().el)}};$(document).ready(function(a){app.Global.Router=new app.Routers();Backbone.history.start({root:"/"})});